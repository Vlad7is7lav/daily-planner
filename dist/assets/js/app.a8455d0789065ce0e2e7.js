!function(e){function t(t){for(var s,n,o=t[0],r=t[1],c=t[2],u=0,h=[];u<o.length;u++)n=o[u],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&h.push(a[n][0]),a[n]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);for(d&&d(t);h.length;)h.shift()();return l.push.apply(l,c||[]),i()}function i(){for(var e,t=0;t<l.length;t++){for(var i=l[t],s=!0,o=1;o<i.length;o++){var r=i[o];0!==a[r]&&(s=!1)}s&&(l.splice(t--,1),e=n(n.s=i[0]))}return e}var s={},a={0:0},l=[];function n(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=s,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var o=window.webpackJsonp=window.webpackJsonp||[],r=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=r;l.push([39,1]),i()}({11:function(e,t){},30:function(e,t,i){var s=i(31);"string"==typeof s&&(s=[[e.i,s,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(2)(s,a);s.locals&&(e.exports=s.locals)},31:function(e,t,i){},33:function(e,t,i){var s=i(34);"string"==typeof s&&(s=[[e.i,s,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(2)(s,a);s.locals&&(e.exports=s.locals)},34:function(e,t,i){},35:function(e,t,i){var s=i(36);"string"==typeof s&&(s=[[e.i,s,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(2)(s,a);s.locals&&(e.exports=s.locals)},36:function(e,t,i){},39:function(e,t,i){"use strict";function s(e,t,i){let s=document.createElement(e);for(let e in t)s[e]=t[e];return"input"==e&"text"==t.type&&(s.setAttribute("required",!0),s.setAttribute("maxlength",40)),i&&("input"==e?s.value=i:s.textContent=i),s}i.r(t);let a=document.getElementById("canvas"),l=document.getElementById("circle");a.width=270,a.height=270,[l.width,l.height]=[270,270];var n=a.getContext("2d"),o=l.getContext("2d");n.strokeStyle=o.strokeStyle="#5f8087",n.lineCap="round",n.shadowBlur=o.shadowBlur=6,n.shadowColor=o.shadowColor="#d2f4fb";function r(e){return e*(Math.PI/180)}function c(e,t){t&&(e.checked=!1);let i=document.querySelectorAll("section.active .tabs_content_list_item");if(0==i.length)return;let s=document.getElementById("active");if(1==s.checked&&(s.checked=!1),1==e.checked)for(let e of i){"line-through"!=e.querySelector(".label").style.textDecoration?e.classList.add("none"):(e.style.display="",e.classList.remove("none"))}else for(let e of i)e.classList.remove("none")}function d(e,t){t&&(e.checked=!1);let i=document.querySelectorAll("section.active .tabs_content_list_item");if(0==i.length)return;let s=document.getElementById("completed");if(1==s.checked&&(s.checked=!1),1==e.checked)for(let e of i){"line-through"==e.querySelector(".label").style.textDecoration?e.classList.add("none"):(e.style.display="",e.classList.remove("none"))}else for(let e of i)e.classList.remove("none")}!function(){let e=new Date,t=e.toString().slice(0,3),i=e.getDate();o.lineWidth=2,o.beginPath(),o.arc(135,135,110,0,360),o.moveTo(220,135),o.arc(135,135,85,0,360),o.moveTo(195,135),o.arc(135,135,60,0,360),o.stroke(),o.fillStyle="#1d71c5",o.font="21px Segoe Print",o.fillText(t,84,159),o.fillText("/",130,159),o.fillText(i,142,159)}(),function e(){let t=new Date,i=(t.getFullYear(),t.getDate(),t.getHours()%12),s=t.getHours(),l=t.getMinutes(),c=r(.6*(t.getSeconds()+t.getMilliseconds()/1e3).toFixed(1)/.1-90).toFixed(6),d=r(6*l-90),u=r(30*i+.5*l-90),h=110*Math.cos(c),m=110*Math.sin(c),g=85*Math.cos(d),p=85*Math.sin(d),v=60*Math.cos(u),f=60*Math.sin(u);n.clearRect(0,0,a.width,a.width),o.setLineDash([0,0]),n.lineWidth=6,n.beginPath(),n.fillStyle="#5f8087",n.arc(135+h,135+m,4,0,360),n.closePath(),n.stroke(),n.fill(),n.beginPath(),n.arc(135+g,135+p,7,0,360),n.stroke(),n.fill(),n.beginPath(),n.arc(135+v,135+f,9,0,360),n.stroke(),n.fill(),n.beginPath(),n.arc(135,135,1,0,360),n.stroke(),n.fillStyle="#1d71c5",n.font="21px Segoe Print",l<10&&(l="0"+l),s<10&&(s="0"+s),n.fillText(s+":"+l,101,123),window.requestAnimationFrame(e)}(),function(){let e=document.querySelector(".weatherAPI_grad"),t=document.getElementById("city_name");document.getElementById("search-icon");function i(){let i=new XMLHttpRequest,s=`http://api.openweathermap.org/data/2.5/weather?q=${t.value}&appid=08376460c140cfb4ce2efbb062ba72c3&units=metric`;i.open("GET",s,!0),i.onload=function(){if(200!=i.status)e.innerHTML="Connection failed. </br> Try Later.",e.style.fontSize="24px",e.style.color="red";else{let t=JSON.parse(i.responseText);e.style.fontSize="70px",e.style.color="#5f8087",e.innerText=t.main.temp+"°C"}},i.send(null)}t.addEventListener("focusout",e=>{i()}),i()}();i(11);var u=class extends class{constructor(){this.events={}}on(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)}emit(e,...t){this.events[e]&&this.events[e].forEach(e=>e(t[0],t[1]))}}{constructor(){super(),this.selectYear=document.querySelector(".selectYear"),this.selectMonth=document.querySelector(".selectMonth"),this.calendarBlock=document.querySelector(".calendarBlock"),this.flag=0,this.months=["January","Febriary","March","April","May","June","July","August","September","October","November","December"],this.tabs=0,this.varsObject={},this.date="",this.eventListeners=null,this.editFlag=!1,this.currentElem=null,this.initilise(),this.tempData,this.currentName,this.popupModal={overlay:document.querySelector(".overlay"),goButton:document.getElementById("go"),cancelButton:document.getElementById("cancel"),popupInput:document.getElementById("popupInput")}}initilise(){this.onload(),this.addEventListeners()}onload(){this.varsObject.calendarDate_year=document.querySelector(".calendarDate_year"),this.varsObject.calendarDate_month=document.querySelector(".calendarDate_month"),window.onload=()=>{this.emit("auth")}}addEventListeners(){document.addEventListener("click",this.closeSelected.bind(this));document.querySelector(".closeForm").addEventListener("click",this.closeLoginForm.bind(this));const e=document.getElementById("form-sign-in");e.addEventListener("submit",t=>this.loginUser(t,e.lastElementChild));const t=document.getElementById("form-sign-up");t.addEventListener("submit",e=>this.registerUser(e,t.lastElementChild));document.querySelector(".login").addEventListener("click",this.openLoginForm.bind(this,e.lastElementChild,t.lastElementChild));document.querySelector(".tabs").addEventListener("click",this.changeTab.bind(this));let i=document.getElementById("completed"),s=document.getElementById("active");s.addEventListener("change",()=>d(s)),i.addEventListener("change",()=>c(i)),this.varsObject.calendarDate_year.addEventListener("click",this.openSelectYear.bind(this)),this.varsObject.calendarDate_month.addEventListener("click",this.openSelectMonth.bind(this));const a=document.querySelector("table");a.addEventListener("mouseover",this.tableMouseOver.bind(this)),a.addEventListener("mouseout",this.tableMouseOut.bind(this))}openLoginForm(e,t){e.disabled=!1,t.disabled=!1;const i=document.querySelector(".logreg"),s=document.querySelector(".button1"),a=document.querySelector(".button2"),l=document.querySelectorAll(".back"),n=document.querySelector(".wrapper");if(s.addEventListener("click",this.openSignInForm.bind(this,n)),a.addEventListener("click",this.openSignUpForm.bind(this,n)),Array.prototype.slice.call(l).forEach(e=>{e.addEventListener("click",this.backToMain.bind(this,n))}),i.classList.contains("showLoginForm"))return this.closeLoginForm();i.classList.add("showLoginForm")}closeLoginForm(){document.querySelector(".logreg").classList.remove("showLoginForm")}openSignInForm(e){e.style.marginLeft="0px"}openSignUpForm(e){e.style.marginLeft="-1000px"}backToMain(e){e.style.marginLeft="-500px"}registerUser(e,t){e.preventDefault();const i=document.querySelector("#email-up"),s=document.querySelector("#password-up");if(!i.value||!s.value||s.value.length<8)return alert("Заполните все поля");console.log(1),this.emit("registerUser",i.value,s.value)}showRegisterMessage(e){switch(e){case 1:let e=document.querySelector(".wrapper-sign_up"),t=document.createElement("div");t.classList.add("registerFalse"),t.innerHTML="Sorry, this login email already exists",e.append(t),console.log(e.firstElementChild),setTimeout(()=>{e.lastElementChild.remove()},1500);break;case 0:let i=document.querySelector(".wrapper-sign_up"),s=document.createElement("div");s.classList.add("registerTrue"),s.innerHTML="Congratulation! </br> Use your login and pass to sign in!",i.append(s);const a=document.querySelector(".wrapper");setTimeout(()=>{i.lastElementChild.remove(),this.openSignInForm(a)},1500)}}showLoginMessage(e,t,i){switch(e){case 1:let e=document.querySelector(".wrapper-sign_in"),s=document.createElement("div");s.classList.add("loginFalse"),s.innerHTML="You have entered an invalid email or password",e.append(s),console.log(e.firstElementChild),setTimeout(()=>{},2e3);break;case 0:let a=document.querySelector(".wrapper-sign_in"),l=document.createElement("div");l.classList.add("loginTrue"),l.innerHTML="You are logged in.",a.append(l);document.querySelector(".wrapper");let n=new Date;setTimeout(()=>{a.lastElementChild.remove(),this.closeLoginForm(),this.openExitForm(),this.changeDate(n.getFullYear(),n.getMonth()),this.reRender()},1e3);break;case 2:i.replaceWith(t)}}openExitForm(){const e=document.querySelector(".login");let t=document.createElement("div");t.classList.add("login"),t.innerHTML='<i class="fas fa-sign-out-alt" style="margin-right: 5px;"></i> Выход',t.addEventListener("click",this.logoutUser.bind(this,e,t)),e.replaceWith(t)}loginUser(e,t){e.preventDefault();const i=document.querySelector("#email-in"),s=document.querySelector("#password-in");if(!i.value||!s.value||s.value.length<8)return alert("Заполните все поля");t.disabled=!0,this.emit("loginUser",i.value,s.value)}logoutUser(e,t){this.emit("logoutUser",e,t)}reRender(){let e=new Date;this.changeDate(e.getFullYear(),e.getMonth());let t=document.querySelector(".tabs");t.textContent="",t.nextElementSibling.textContent=""}tableMouseOver(e){if(this.currentElem)return;const t=e.target.closest("td");t&&(this.currentElem=t,""!=t.textContent&&this.showPlus(e))}tableMouseOut(e){if(!this.currentElem)return;let t=e.relatedTarget;if("TD"!=e.target.tagName||""!=e.target.textContent){for(;t;){if(t==this.currentElem)return;t=t.parentNode}this.hidePlus(e),this.currentElem=null}}showPlus(e){let t=document.createElement("I");t.className="fas fa-plus-circle showPlus",e.target.appendChild(t);let i=t.addEventListener("click",this.addNameForTab.bind(this,e));t.removeEventListener("click",i)}addNameForTab(e){let t=e.target.innerText,i=this.date;t<10&&(t="0"+t),this.date.length>7&&(i=this.date.slice(3)),i=`${t}-${i}`,this.emit("getNeededData",i)}getArray(e,t){if(console.log(t),this.tempData=e,!(e.length<3))return console.log("Max tasks for day is 3");{let{overlay:i,goButton:s,cancelButton:a,popupInput:l}=this.popupModal;i.classList.add("showModal"),s.onclick=()=>{if(!this.checkName(l.value,e))return l.placeholder=l.value+" is already use",void(l.value="");i.classList.remove("showModal"),this.date=t,this.hCreateTab(this.date,l.value),this.currentName=l.value,setTimeout(()=>{l.value="",l.placeholder="Enter the list name"},1e3)},a.onclick=()=>{i.classList.remove("showModal")}}}checkName(e,t){if(!e)return!1;let i=t.every(t=>t.name!=e);return console.log(i,"listName"),i}hidePlus(e){"I"!=e.target.tagName?null!=e.target.firstElementChild&&"I"==e.target.firstElementChild.tagName&&e.target.firstElementChild.remove():e.target.remove()}openSelectYear(e){this.selectYear.classList.toggle("beVisible"),this.selectMonth.classList.remove("beVisible"),this.flag=1}openSelectMonth(e){this.selectMonth.classList.toggle("beVisible"),this.selectYear.classList.remove("beVisible"),this.flag=1}closeSelected(e){let t,i=e.target,s=this.varsObject.calendarDate_year,a=this.varsObject.calendarDate_month;1==this.flag&&("cells"==i.className?(this.selectYear.classList.remove("beVisible"),s.innerText=i.innerText,t=a.getAttribute("data-month"),this.changeDate(s.innerText,t),this.flag=0):"cellsM"==i.className?(this.selectMonth.classList.remove("beVisible"),t=i.getAttribute("data-month"),a.innerText=this.months[t],this.changeDate(s.innerText,t),this.flag=0):i.className!=s.className&&i.className!=a.className&&(this.selectYear.classList.remove("beVisible"),this.selectMonth.classList.remove("beVisible"),this.flag=0))}changeDate(e,t){let i=document.getElementById("days");const s=function(e,t){let i=new Date(e,t,32),s=new Date(e,t).getDay(),a=32-i.getDate(),l=(new Date(e,t,32).getDate(),"<tr>"),n=1;for(let e=1;e<=s;e++)l+="<td></td>",n++;for(let e=1;e<=a;e++)n>7&&(l+="</tr><tr>",n=1),l+=`<td data-cell=${e>9?"":0}${e}> ${e} </td>`,n++;for(let e=n;e<=7;e++)l+="<td></td>",n++;return l+="</tr>",l}(e,t);i.innerHTML=s,this.varsObject.calendarDate_month.setAttribute("data-month",t),this.varsObject.calendarDate_month.innerText=this.months[t],this.varsObject.calendarDate_year.innerText=e;let a=[...document.querySelectorAll("tbody td")];t=t<10?"0"+(+t+1):+t+1;for(let i of a)i.getAttribute("data-cell")&&i.addEventListener("click",this.checkDayTask.bind(this,e,t));this.emit("getAllData",t,e),this.date=`${t}-${e}`;let l=document.querySelector(".lists");for(;l.firstChild;)l.removeChild(l.firstChild)}checkDayTask(e,t,i){if(console.log(i.target,"target"),"I"===i.target.tagName)return;let s=i.target.getAttribute("data-cell");console.log(this.date),this.date=`${s}-${t}-${e}`,this.emit("checkDataToOpen",this.date,i)}hSelectList(e,t){let i=document.querySelector(".calendarDate_year").innerText,a=+document.querySelector(".calendarDate_month").getAttribute("data-month")+1;a<10&&(a="0"+a);const l=`${e.target.getAttribute("data-cell")}-${a}-${i}`,n=document.querySelector(".selectList");n.innerText="";let o=s("div",{className:"lists"});t.forEach((e,t)=>{let i=s("div",{className:"list list_"+t}),a=s("span",{},e.listName),n=s("i",{className:"fas fa-times"});i.setAttribute("fullDate",l),i.setAttribute("data-id",e._id),i.appendChild(a),i.appendChild(n),o.appendChild(i),n.addEventListener("click",this.deleteList.bind(this,e)),i.addEventListener("click",this.showList.bind(this,e))}),n.appendChild(o),setTimeout(()=>{o.classList.add("show")},0)}showList(e,t){"I"!==t.target.tagName&&this.hCreateTab(t,e.listName,e)}deleteList(e,t){this.emit("deleteList",{_id:e._id},t);let i=document.querySelectorAll(".tab");if(Array.prototype.slice.call(i).forEach((t,i)=>{t.getAttribute("data-id")!==e._id||this.closeList(null,t.lastElementChild)}),!t){let t=document.querySelector(`div.list[data-id="${e._id}"]`);return console.log(t),void t.remove()}t.target.closest(".list").remove()}removeCircle(e){let t;t="0"==e[0]?e.slice(1,2):e.slice(0,2),console.log(t);let i=[...document.querySelectorAll("tbody td")];for(let e of i)e.innerText===t&&(e.classList.remove("circleOn"),console.log(e.innerText))}hCreateTab(e,t,i){const a=document.querySelectorAll(".tabs_content > section"),l=document.querySelectorAll(".tabs > .tab");let n=Array.from(l);const o=document.getElementById("active");if(c(document.getElementById("completed"),!0),d(o,!0),n.length>0){let e=0;for(let i=0;i<n.length;i++)0==e&&n[i].firstChild.textContent==this.date&&n[i].firstElementChild.textContent==t?(n[i].classList.add("active"),e=1,this.changeTab(null,i)):n[i].classList.remove("active");if(1===e)return}null!=a&&Array.from(a).forEach((function(e){e.classList.remove("active")})),3==this.tabs&&(document.querySelectorAll(".tab")[this.tabs-1].remove(),document.querySelector(".tabs_content").lastElementChild.remove(),this.tabs=2);let r=document.querySelector(".tabs"),u=s("div",{className:"tab active"},this.date),h=s("div",{className:"tabName"},t),m=s("div",{className:"list_delete"});m.innerHTML='<i class="fas fa-times"></i>',m.addEventListener("click",this.closeList.bind(this)),u.append(h),u.append(m),r.insertBefore(u,r.firstElementChild),this.tabs++,this.createSection();const g=document.querySelector("div.tabs > div.active");if(i){g.setAttribute("data-id",i._id);for(let e of i.todos)this.createItem(e)}else g.setAttribute("data-id","null"),this.createItem()}createSection(){const e=document.querySelector(".tabs_content");let t=s("section",{className:"tab_content active"}),i=s("ul",{className:"tabs_content_list"});if(t.appendChild(i),e.insertBefore(t,e.firstElementChild),null==this.eventListeners){document.querySelector(".no-filter.addItem").addEventListener("click",this.hAddItem.bind(this)),this.eventListeners="ACTIVATED"}}createItem(e){let t;const i=document.querySelector("section.active > .tabs_content_list");if(i.querySelectorAll("input[type=text]").length>18)return alert("Free version allows you create only 18 tasks");null!=e?t={li:"tabs_content_list_item",label:"label",input:"textfield input_hide"}:(t={li:"tabs_content_list_item",label:"label label_Hide",input:"textfield"},e={item:"",complete:!1}),console.log(e.complete);let a=this.getRandomID(5e3),l=s("li",{className:t.li}),n=s("label",{className:"marker"}),o=s("input",{id:a,type:"checkbox",className:"checkbox",name:"check",checked:e.complete}),r=s("div",{className:"itemCheck"}),c=s("label",{className:t.label||"label"},e.item),d=s("input",{type:"text",className:t.input},e.item);l.innerHTML='<div class="item_delete"><i class="fas fa-times"></i></div></li>',console.log(e.complete),!0===e.complete&&(c.style.textDecoration="line-through",c.setAttribute("data-complete",!0)),n.appendChild(o),n.appendChild(r),l.appendChild(n),l.appendChild(c),l.appendChild(d),i.appendChild(l);const u=i.querySelectorAll("input[type=text]");u[u.length-1].focus(),this.todoEventListeners(l)}getRandomID(e){return Math.floor(Math.random()*Math.floor(e))}todoEventListeners(e){const t=e.querySelector("div > i.fas"),i=e.querySelector("input[type=text]"),s=e.querySelector("label.label"),a=e.querySelector("input[type=checkbox]");return e.addEventListener("click",this.editItem.bind(this,i,s)),t.addEventListener("click",this.hdeleteItem.bind(this)),i.addEventListener("keydown",this.hAddItem.bind(this)),i.addEventListener("focusout",this.catch_focusOut.bind(this)),a.addEventListener("click",this.crossItem.bind(this)),e}hdeleteItem(e){e.preventDefault();const t=document.querySelector("div.tabs > div.active").getAttribute("data-id"),i=[...document.querySelectorAll("section.active .item_delete i")];let s=i.indexOf(e.target);console.log({_id:t,index:s}),this.emit("deleteItem",{_id:t,index:s,date:this.date},e),this.isTask(i,!0)}hupdateItem(e){e.preventDefault();const t=e.target.value,i=this.date,s=document.querySelector("div.tabs > div.active").getAttribute("data-id");let a=[...document.querySelectorAll("section.active input[type=text]")].indexOf(e.target);console.log({_id:s,date:i,name:this.currentName,item:t,complete:!1,index:a}),this.emit("updateItem",{_id:s,date:i,name:this.currentName,item:t,complete:!1,index:a},e)}hupdateCompState(e,t){const i=this.date,s=document.querySelector("div.tabs > div.active").getAttribute("data-id");let a=[...document.querySelectorAll("section.active label.label")].indexOf(e);console.log({_id:s,date:i,name:this.currentName,item:e.innerText,complete:t,index:a}),this.emit("updateItem",{_id:s,date:i,name:this.currentName,item:e.innerText,complete:t,index:a})}hAddToDo(e){e.preventDefault();const t=this.date,i=document.querySelector("div.tabs > div.active").getAttribute("data-id"),s=e.target.value;console.log({_id:i,date:t,name:this.currentName,item:s,complete:"false"}),this.emit("addToDo",{_id:i,date:t,name:this.currentName,item:s,complete:!1},e),this.isTask(),this.addItem(e)}catch_focusOut(e){if("focusout"==e.type){if(""==e.target.value)return void e.target.parentNode.remove();let t=e.target;t.value=t.value.trim();let i=t.value,s=t.previousElementSibling,a=s.innerText;const l=e.target.closest("ul").querySelectorAll("input").length;if(t.classList.add("input_hide"),s.innerText=i,s.classList.remove("label_Hide"),!0===this.editFlag&&e.target.value!=a)return this.editFlag=!1,console.log("catch",e),void this.hupdateItem(e);if(this.editFlag=!1,l<=1&&""===e.target.value||e.target.value===a)return;console.log(e.target.value),this.hAddToDo(e)}}closeList(e,t){if(null!=t)console.log(t.closest(".tab")),i=t.closest(".tab");else var i=e.target;const s=i.closest(".tab");console.log(s);const a=[...document.querySelectorAll(".tab")],l=[...document.querySelectorAll(".tab_content")],n=a.indexOf(s);s.classList.contains("active")&&a.length>1&&(n===a.length-1?(s.previousElementSibling.classList.add("active"),l[n-1].classList.add("active")):(s.nextElementSibling.classList.add("active"),l[n+1].classList.add("active"))),s.remove(),l[n].remove(),this.tabs--}addItem(e,t=null){e.target.classList.add("input_hide"),e.target.previousElementSibling.classList.remove("label_Hide")}setID(e){document.querySelector("div.tabs > div.active").setAttribute("data-id",e)}deleteItem(e){let t=e.target;for(;"LI"!=t.tagName;)t=t.parentNode;t.classList.add("none"),setTimeout(()=>{t.remove()},1e3)}updateItem(e){let t=e.target;t.value=t.value.trim();let i=t.value,s=t.previousElementSibling;t.classList.add("input_hide"),s.innerText=i,s.classList.remove("label_Hide")}isTask(e,t,i){const s=[...document.querySelectorAll("section.active > .tabs_content_list input[type=text]")];let a=[...document.querySelectorAll("tbody td")],l=this.date.slice(0,2);if(s.length>=1&&!t)for(let e of a)e.dataset.cell===l&&e.classList.add("circleOn");else if(s.length<=1)for(let e of a)e.dataset.cell===l&&e.classList.remove("circleOn")}hAddItem(e){let t=e,i=0,s=t.target,a=s.value,l=s.previousElementSibling;if(27==t.keyCode)return s.value=l.innerText,s.classList.add("input_hide"),void l.classList.remove("label_Hide");if(!(13!=t.keyCode&"focusout"!=t.type&"I"!=t.target.tagName)){if(t.ctrlKey&13==t.keyCode){if(!t.target.value)return;return!0===this.editFlag?(console.log("edti",t),void this.hupdateItem(t)):void(a!=l.innerText?(l.innerText=a.trim(),this.hAddToDo(t)):(s.classList.add("input_hide"),s.previousElementSibling.classList.remove("label_Hide")))}if("click"!=t.type){if(13==t.keyCode){if(t.preventDefault(),!t.target.value)return;const s=document.querySelectorAll("section.active > .tabs_content_list input[type=text]");let a=e.target.value.trim();t.target.value=a;for(let e of s)if(!this.itemIsEmpty(e))return e.classList.remove("input_hide"),e.previousSibling.classList.add("label_Hide"),void e.focus();return this.itemOut(1),this.createItem(),void(i=1)}}else{if("far fa-plus-square"==t.target.classList){let e=document.querySelectorAll("section.active > .tabs_content_list input[type=text]");if(null===e)return;for(let t of e)if(!this.itemIsEmpty(t))return t.classList.remove("input_hide"),t.previousSibling.classList.add("label_Hide"),void t.focus();if(!document.querySelector("section.active"))return;return void this.createItem()}this.itemIsEmpty()}}}itemOut(e,t){const i=document.querySelectorAll("section.active > .tabs_content_list input[type=text]"),s=i[i.length-e].previousElementSibling,a=i[i.length-e];a.classList.add("input_hide"),s.classList.remove("label_Hide"),s.innerText=i[i.length-e].value,a.blur()}crossItem(e){const t=e.target.closest("li").querySelector("label.label");let i;"line-through"==t.style.textDecoration?(t.style.textDecoration="none",t.removeAttribute("data-complete"),i=!1):(t.style.textDecoration="line-through",t.setAttribute("data-complete","true"),i=!0),this.hupdateCompState(t,i)}editItem(e,t,i){"label"==i.target.className&&(this.editFlag=!0,e.value=t.innerText,e.classList.remove("input_hide"),t.classList.add("label_Hide"),e.focus())}itemIsEmpty(e){return""!=e.value.trim()&&(e.blur(),!0)}changeTab(e,t){let i;const s=document.querySelectorAll(".tabs > .tab"),a=document.querySelectorAll(".tabs_content > .tab_content");if(null==e)return Array.prototype.slice.call(a).forEach((function(e,t){e.classList.remove("active")})),void a[t].classList.add("active");if("tab active"==e.target.classList||"tab active"==e.target.parentNode.classList)return;e.target.parentNode.classList.contains("tab")?(console.log(e.target.parentNode),i=e.target.parentNode):(i=t||e.target,console.log(i));if(t&&i.classList.remove("active"),"tab"==i.className){Array.prototype.slice.call(s).forEach((function(e,t){e.classList.remove("active")})),i.classList.add("active"),this.currentName=i.querySelector(".tabName").innerText;let e=new RegExp("^[0-9]{2}.[0-9]{2}.[1-2][0-9]{3}");this.date=e.exec(i.innerText)[0],Array.prototype.slice.call(a).forEach((function(e,t){e.classList.remove("active")}));for(let e=0;e<s.length;e++)i==s[e]&&a[e].classList.add("active")}}},h=i(1),m=i.n(h);var g=class{constructor(e=[]){this.state=e,this.db=null}getTaskList(e,t,i){if(0===i&&!t)return this.state.find(t=>t.id==e);if(0===i&&t){let e=this.state.find(e=>e.name==t);return console.log(e,"findlist"),e}this.state.forEach((function(e,t){}));let s=[];if(1===i){let i;return this.state.forEach(s=>{s.id==e&&s.name==t&&(i={item:s.id,name:s.name,tasks:s.tasks})}),console.log(i,"fil tasks"),i}return this.state.forEach(t=>{t.id==e&&s.push({item:t.id,name:t.name})}),console.log(s,"fil"),s}async addTaskList(e){return null===e._id?await this.addList(e):(void 0===isObj?this.state.push(e):isObj.tasks.push(e.tasks[0]),console.log(this.state,"add123123"),e)}updateComp(e){console.log(e,"update Compstate");let t=this.getTaskList(e.id,e.name,0).tasks[e.index];return t.completed=e.completed,console.log(t),console.log(this.state,"updComp"),this.state}datesFromState(){return Array.from(this.state,({id:e})=>e)}async getAllData(){const e=await m.a.get("/lists/all_lists").then(e=>e.data);console.log(e);let{auth:t,data:i}=e;return{auth:t,data:i}}async getList(e){return await m.a.get("/lists/list?id="+e._id).then(e=>e.data)}async addList(e){return await m.a.post("/lists/list",e).then(e=>e.data)}async deleteList(e){return await m.a.delete("/lists/list?id="+e._id)}async addTask(e){return await m.a.post("/lists//list/add_task",e).then(e=>e.data)}async updateItem(e){return await m.a.patch("/lists/list/update_item",e).then(e=>e.data)}async deleteItem(e){return await m.a.patch("/lists/list/del_task",e).then(e=>e.data)}async registerUser(e){return await m.a.post("/user/register",e).then(e=>e.data)}async loginUser(e){const t=await m.a.post("/user/login",e).then(e=>e.data);let{auth:i,message:s,userData:a}=t;return{auth:i,message:s,userData:a}}async logoutUser(){const e=await m.a.get("/user/logout").then(e=>e.data);console.log(e);let{auth:t,logout:i}=e;return{auth:t,logout:i}}async userAuth(e){const t=await m.a.get("/user/auth").then(e=>e.data);return console.log(t),t.auth||console.log("Please, login first",t.message),t}};var p=class{constructor(e,t){this.model=e,this.view=t,this.data=[],this.isAuth=!1,this.pseudoID=0,this.view.on("addToDo",this.addToDo.bind(this)),this.view.on("updateItem",this.updateItem.bind(this)),this.view.on("deleteItem",this.deleteItem.bind(this)),this.view.on("updateCompState",this.updateCompState.bind(this)),this.view.on("getAllData",this.getAllData.bind(this)),this.view.on("checkDataM",this.checkDataM.bind(this)),this.view.on("getNeededData",this.getNeededData.bind(this)),this.view.on("checkDataToOpen",this.checkDataToOpen.bind(this)),this.view.on("deleteList",this.deleteList.bind(this)),this.view.on("loginUser",this.loginUser.bind(this)),this.view.on("logoutUser",this.logoutUser.bind(this)),this.view.on("registerUser",this.registerUser.bind(this)),this.view.on("auth",this.auth.bind(this))}async auth(){let e=await this.model.userAuth();this.isAuth=e.auth,console.log(this.isAuth),e.auth&&this.view.showLoginMessage(0);let t=new Date;this.view.changeDate(t.getFullYear(),t.getMonth())}checkDataM(e,t,i){console.log(e,t,"checkDataM1");const s=this.model.getTaskList(e,t,1);s&&this.view.hCreateTab(i,t,s)}getNeededData(e){const t=this.model.getTaskList(e);console.log(t,"checkNeededs"),this.view.getArray(t,e)}async addToDo(e,t){let i;if("null"==e._id){if(!this.isAuth)return this.data.push({_id:++this.pseudoID,date:e.date,listName:e.name,todos:[{item:e.item,complete:e.complete}]}),this.view.setID(this.pseudoID),void console.log(this.data);i=await this.model.addList({date:e.date,listName:e.name,todos:{item:e.item,complete:e.complete}}),this.data.push(i.data),this.view.setID(i.data._id)}else{if(console.log(e._id,this.data),this.data.find(t=>t._id==e._id).todos.push({item:e.item,complete:e.complete}),!this.isAuth)return;i=await this.model.addTask({_id:e._id,date:e.date,listName:e.name,todos:{item:e.item,complete:e.complete}})}}async updateItem(e,t){await this.model.updateItem({_id:e._id,todos:{item:e.item,complete:e.complete},index:e.index});if(this.data.find(t=>t._id==e._id).todos[e.index]={item:e.item,complete:e.complete},console.log(this.data,"cross"),void 0!==t)return this.view.updateItem(t),this.data}updateCompState(e,t){if(this.model.getTaskList(e.id,e.name)){this.model.updateComp({id:e.id,name:e.name,index:e.index,completed:e.complete})}}async deleteItem(e,t){const i=await this.model.deleteItem({_id:e._id,index:e.index});this.view.deleteItem(t),console.log(i),0===i.data.todos.length&&this.view.deleteList(e),this.data.find(t=>t._id==e._id).todos.splice(e.index,1),console.log(this.data)}async deleteList(e,t){let i=await this.model.getList(e);if(!0===i.success){await this.model.deleteList(e)}let s=this.data.findIndex(t=>t._id===e._id);~s&&this.data.splice(s,1),console.log(i.data),console.log(this.data),this.view.removeCircle(i.data.date)}checkDataToOpen(e,t){const i=this.data.filter(t=>t.date==e);return i&&this.view.hSelectList(t,i),null}async getAllData(e,t){let i=`${e}-${t}`,s=await this.model.getAllData();this.data=s.data,this.isAuth=s.auth;let a=Array.from(this.data,({date:e})=>e);[...document.querySelectorAll("tbody td")].forEach(e=>{console.log(i);let t=e.getAttribute("data-cell");a.indexOf(`${t}-${i}`)>=0&&(e.classList.add("circleOn"),e.setAttribute("data-task","true"))}),console.log(this.data)}async registerUser(e,t){console.log("registerUser");let i={email:e,password:t},s=await this.model.registerUser(i);if(console.log(s),"duplicate"==s.message)return this.view.showRegisterMessage(1);this.view.showRegisterMessage(0)}async loginUser(e,t){let i={email:e,password:t};if(0==(await this.model.loginUser(i)).auth)return this.view.showLoginMessage(1);this.view.showLoginMessage(0)}async logoutUser(e,t){await this.model.logoutUser();this.data=[],this.view.reRender(),this.view.showLoginMessage(2,e,t)}};i(30),i(33),i(35),i(37);new p(new g([{id:"01.02.2021",name:"Fruit",tasks:[{item:"1",completed:!1},{item:"2",completed:!1},{item:"3",completed:!0},{item:"4",completed:!0}]},{id:"28.02.2021",name:"Travel",tasks:[{item:"1",completed:!0},{item:"2",completed:!0},{item:"3",completed:!0},{item:"4",completed:!0}]},{id:"12.02.2021",name:"Fruit3",tasks:[{item:"5",completed:!0},{item:"6",completed:!1},{item:"7",completed:!1},{item:"8",completed:!1}]},{id:"12.02.2021",name:"Fruit",tasks:[{item:"9",completed:!1},{item:"10",completed:!1},{item:"11",completed:!0},{item:"12",completed:!1}]}]),new u)}});